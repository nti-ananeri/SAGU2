<?php

/**
 * Default defines 
 * To report identification
 */
$MIOLO  = MIOLO::getInstance();
$module = MIOLO::getCurrentModule();

define('REPORT_ID', 'SP001'); 
define('FPDF_FONTPATH', $MIOLO->getModulePath('basic', '/classes/fpdf/font/'));

$MIOLO->Uses('classes/fpdf/fpdf.php', 'basic');

/**
 * Create header and footer information
 */
class PDF extends FPDF
{
    var $type = 0;
    var $periodId = 0;
    /**
     * Defines the footer for this report
     */
//     public function Footer()
//     {
//         $module = MIOLO::getCurrentModule();
//         $this->setY(-15);
//         $pn = $this->PageNo().'/{nb}';
//         $this->cell(190, 1, '', 'B', 1);
//         $this->ln();
// 
//         $this->setFont(DEFAULT_REPORT_FONT, 'I', 8);
//         $this->cell(50, 4, $text, 0, 0);
//         $this->cell(140, 4, _M('REPORT @1 ', $module, REPORT_ID).' '._M('Page @1', $module, $pn), 0, 0, 'R');
//         $this->ln();
//     }

    /**
     * Defines the header for this report
     */
    public function Header()
    {
        $module = MIOLO::getCurrentModule();

        $this->ln();
        $this->setFont(DEFAULT_REPORT_FONT, 'B', 16);
        $this->cell(190, 8, _M('Signature list', $module) . ' ' . $this->periodId, 8, '','C');
        $this->ln();
        $this->ln();
    }
}


/**
 * PDF extension to generate report
 */
class RptSignature 
{
    /**
     * Method to generate the report
     */
    public function RptSignature($data = null)
    {
//        $rdata  = $this->getReportData($data);
        $module = MIOLO::getCurrentModule();

        // Generating PDF file
        $this->pdf = new PDF();
        $this->pdf->aliasNbPages();

        $this->pdf->periodId = $data['periodId'];

        // First page
        $this->generateContent($data);

        $this->pdf->close();
        $this->pdf->output();
    }

    /**
     * Get report data information
     */
//     private function getReportData($data)
//     {
//         $MIOLO  = MIOLO::getInstance();
//         $module = MIOLO::getCurrentModule();
// 
// //         Inscription information
// 
//         $rdata->selectiveProcessId = $data->selectiveProcessId;
//         $rdata->cityExamId         = $data->cityExamId;
// 
//         $busExamAct     = $MIOLO->getBusiness($module, 'BusExamAct');
//         $roomsBuildCity = $busExamAct->roomsOfAct($rdata);
//         $rdata->roomsBuildCity = $roomsBuildCity;
// 
//         $busCompany  = $MIOLO->getBusiness(basic, 'BusCompany');
//         $company = $busCompany->getCompany(DEFAULT_COMPANY_CONF);
// 
//         $rdata->file = $company->personId;
// 
//         return $rdata;
//     }

    private function generateContent($rdata)
    {
        $MIOLO  = MIOLO::getInstance();
        $module = MIOLO::getCurrentModule();

        $this->pdf->addPage('P', 'mm', 'A4');

        foreach($rdata AS $value1)
        {
            $this->pdf->setFont(DEFAULT_REPORT_FONT, '', 12);

            $this->pdf->cell(35, 10, $value1[0], 0, 0, 'L');
            $this->pdf->cell(10, 10, '', 0, 0, 'L');
            $this->pdf->cell(80, 10, $value1[1], 0, 0, 'L');
            $this->pdf->line(($this->pdf->getX()+5), ($this->pdf->getY()+5), ($this->pdf->getX()+70), ($this->pdf->getY()+5));

            $this->pdf->ln(6);
        }
    }
}

?>
