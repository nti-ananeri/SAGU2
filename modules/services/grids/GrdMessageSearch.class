<?php

class GrdMessageSearch extends MGrid
{
    /**
     * Class constructor
     **/
    function __construct($filters)
    {
        $MIOLO = MIOLO::getInstance();
        $home  = $filters->home;

        $columns = array(
                          new MGridColumn( _M('Message id', 'basic'), 'left',  true, null, false, null, false ),
                          new MGridColumn( _M('From id',    'basic'), 'left',  true, null, false, null, false ),
                          new MGridColumn( _M('From',       'basic'), 'left',  true, null, true, null, false ),
                          new MGridColumn( _M('To id',      'basic'), 'left',  true, null, false, null, false ),
                          new MGridColumn( _M('To',         'basic'), 'left',  true, null, false, null, false ),
                          new MGridColumn( _M('Title',      'basic'), 'left',  true, null, true, null, false ),
                          new MGridColumn( _M('Message',    'basic'), 'left',  true, null, false, null, false ),
                          new MGridColumn( _M('Date',       'basic'), 'left',  true, null, true, null, false )
                        );


        unset($opts);
        $url = $MIOLO->getActionURL('services', "$home:search", null, $opts);
        parent::__construct( null, $columns, $url, null, 0, 'GrdMessageSearch' );

        $opts = array('function'  => 'marked',
                      'messageId' => '%0%');
        $href_marked = $MIOLO->getActionURL( 'services', $home, null, $opts );
        $this->addActionIcon( _M('Marked', 'basic'), 'bookmark-16x16.png', $href_marked );

        $opts = array('function'  => 'view',
                      'messageId' => '%0%');
        $href_view = $MIOLO->getActionURL( 'services', $home, null, $opts );
        $this->addActionIcon( _M('View', 'basic'), 'view-16x16.png', $href_view );

        //$this->actions[] =  new MGridActionSelect($this);
        $this->selecteds = array(0);
        $this->eventHandler();
        $this->setRowMethod('GrdMessageSearch', 'myRowMethod');

    }

    public function myRowMethod($i, $row, $actions, $columns )
    {
        $MIOLO  = MIOLO::getInstance();
        $module = MIOLO::getCurrentModule();

        if ( $row[11] == DB_TRUE )
        {
            $actions[0]->value = 'bookmark-16x16.png';
            for ( $x = 1; $x<count($columns); $x++ )
            {
                $columns[$x]->control[$i]->_addStyle( 'color', '#000000' );
            }
        }
        else
        {
            $actions[0]->value = 'bookmark-disabled-16x16.png';
            for ( $x = 1; $x<count($columns); $x++ )
            {
                $columns[$x]->control[$i]->_addStyle( 'color', '#999999' );
            }
        }
    }
}

?>
