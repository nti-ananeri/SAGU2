<?php

/** 
 * Need put more comments
 *
 * @author: William Prigol Lopes [william@solis.coop.br]
 *          Baseed on sources of fpdf.php (www.fpdf.org) to return files to http requester
 * 
 */
class returnFile
{

    /**
     * Output a buffer as a file if headers not modified
     *
     * @param: $fileName (string): File name to return
     * @param: $buffer (string): The buffer data to return as a file
     * @param: $contentType (string) default 'text/plain': Type of content to return
     *
     * @return: Return nothing, send to browser the file and quit the process
     *
     */
    function output($fileName, $buffer, $contentType = 'text/plain')
    {
        if(ob_get_contents())
        {
            $this->Error('Some data has already been output, can\'t send file');
        }
        if(php_sapi_name()!='cli')
        {
            header('Content-Type: '.$contentType);
            if(headers_sent())
            {
                $this->Error('Some data has already been output to browser, can\'t send file');
            }
            header('Content-Length: '.strlen((string)$this->buffer));
            header('Content-disposition: inline; filename="'.$fileName.'"');
        }
        echo $this->buffer;
    }
}
